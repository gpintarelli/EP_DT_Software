function [ Po ] = NormalizePulse( Pi )

% CALIBRATION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% I_Offset = -7.98701905097044; Para 5A
V_Offset = -0.459572024169537;
V_Cal = 0.259765118162674;
% I_Cal = 0.00415030993536574; Para 5A
I_Cal    = 0.00875874;
I_Offset = -16.79976974;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INPUT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
t = Pi(:,1);
V = Pi(:,2)*V_Cal+V_Offset;
I = Pi(:,3)*I_Cal+I_Offset;
H = Pi(:,4);
S = Pi(:,5);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Filtro V %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% fc = 80000;
% fs = 500000;
% 
% [b,a] = butter(2,fc/(fs/2)); % 2 order
% % freqz(b,a); % Shows normalized filter
% V = filter(b,a,V);%dataOut = filter(b,a,dataIn);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ARRUMA DADOS (zera e inverte)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for c = 1:size(Pi(:,1)) % Situação sem pulso
    if S(c,1) == 0
        if H(c,1) == 0
            V(c,1) = 0;
            %I(c,1) = 0;
        end
    end
end

for c = 1:size(Pi(:,1)) % Situação pulso invertido
    if S(c,1) == 1
        if H(c,1) == 0
            V(c,1) = -V(c,1);
            I(c,1) = -I(c,1);
        end
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% ARRUMA DADOS (filtro topo)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% for c = 1:size(Pi(:,1)) % Situação com pulso positivo
%     if S(c,1) == 1
%         if H(c,1) == 1
% 
%         end
%     end
% end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Po = [t , V , I , H , S ];

end

